!function(){"use strict";function t(){}t.prototype={preload:function(){this.load.image("preloader","assets/preloader.gif")},create:function(){this.game.input.maxPointers=1,this.game.device.desktop?this.game.scale.pageAlignHorizontally=!0:(this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.minWidth=480,this.game.scale.minHeight=260,this.game.scale.maxWidth=640,this.game.scale.maxHeight=480,this.game.scale.forceOrientation(!0),this.game.scale.pageAlignHorizontally=!0,this.game.scale.setScreenSize(!0)),this.game.state.start("preloader")}},window["phaser-test2"]=window["phaser-test2"]||{},window["phaser-test2"].Boot=t}(),function(){"use strict";function t(){}t.prototype={}}(),function(){"use strict";function t(){this.bg=null,this.player=null,this.filter=null,this.filterList=[],this.fKey=null,this.spaceKey=null,this.fullScreen=!1,this.helpText=null,this.minigun=null,this.bullets=null,this.bulletTime=0,this.score=0,this.audioExplosion=null,this.audioLaser=null}t.prototype={createHelpText:function(t){var i=this.add.text(this.game.width,this.game.height,t);i.anchor.setTo(1);var e=i.context.createLinearGradient(0,0,0,i.canvas.height);return e.addColorStop(0,"#8ED6FF"),e.addColorStop(1,"#004CB3"),i.fill=e,i.stroke="#000000",i.strokeThickness=1,i.setShadow(5,5,"rgba(0,0,0,0.5)",5),i},loadFilters:function(){var t=this.add.filter("LightBeam",this.game.width,this.game.height);t.alpha=0,this.filterList.push(t),t=this.add.filter("LazerBeam",this.game.width,this.game.height,.2),t.alpha=0,this.filterList.push(t),t=this.add.filter("ColorBars",this.game.width,this.game.height),t.alpha=0,this.filterList.push(t)},create:function(){this.score=0;var t=this.game.width/2,i=this.game.height/2;this.scale.fullScreenScaleMode=Phaser.ScaleManager.EXACT_FIT,this.bg=this.add.sprite(0,0,null),this.bg.width=this.game.width,this.bg.height=this.game.height,this.loadFilters(),this.filter=this.filterList.shift(),this.audioExplosion=this.add.audio("audio-explosion"),this.audioLaser=this.add.audio("audio-laser"),this.bg.filters=[this.filter],this.player=this.add.sprite(t,i,"player"),this.player.anchor.setTo(.5,.5),this.player.enableBody=!0,this.player.physicsBodyType=Phaser.Physics.ARCADE,this.physics.enable(this.player,Phaser.Physics.ARCADE),this.input.onDown.add(this.onInputDown,this),this.fKey=this.input.keyboard.addKey(Phaser.Keyboard.F),this.fKey.onDown.add(this.toggleFullscreen,this,0),this.spaceKey=this.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),this.spaceKey.onDown.add(this.switchFilter,this,0),this.helpText=this.createHelpText("Presione F para pantalla completa."),this.minigun=this.add.sprite(0,this.game.height/2,"minigun"),this.minigun.anchor.setTo(0,.5),this.physics.enable(this.minigun,Phaser.Physics.ARCADE),this.bullets=this.add.group(),this.bullets.enableBody=!0,this.bullets.physicsBodyType=Phaser.Physics.ARCADE;for(var e=0;20>e;e++){var s=this.bullets.create(0,0,"bullet");s.name="bullet"+e,s.exists=!1,s.visible=!1,s.checkWorldBounds=!0,s.events.onOutOfBounds.add(this.resetBullet,this)}this.addScore()},resetBullet:function(t){t.kill()},updateMinigun:function(){this.minigun.body.velocity.x=0,this.minigun.body.velocity.y=0,this.minigun.body.angularVelocity=0,this.input.keyboard.isDown(Phaser.Keyboard.LEFT)?this.minigun.body.angularVelocity=-200:this.input.keyboard.isDown(Phaser.Keyboard.RIGHT)&&(this.minigun.body.angularVelocity=200),this.input.keyboard.isDown(Phaser.Keyboard.Z)&&this.fireBullet()},fireBullet:function(){if(this.time.now>this.bulletTime){var t=this.bullets.getFirstExists(!1),i=this.minigun.toGlobal(new PIXI.Point(this.minigun.width,0));t&&(t.reset(i.x,i.y),t.anchor.setTo(0,.5),t.rotation=this.minigun.rotation,this.physics.arcade.velocityFromRotation(t.rotation,120,t.body.velocity),this.bulletTime=this.time.now+150,this.audioLaser.play())}},switchFilter:function(){this.filterList.push(this.filter),this.filter=this.filterList.shift(),this.bg.filters.pop(),this.bg.filters.push(this.filter)},update:function(){var t,i,e,s,a,h,n,o;this.filter.update(),this.updateMinigun(),this.physics.arcade.overlap(this.player,this.bullets,function(t,i){var e=i.game.add.sprite(i.x,i.y,"explosion");e.anchor.setTo(0,.5);var s=e.animations.add("boom");s.onComplete.add(function(){s.destroy(),e.kill()}),s.play(30,!1),i.kill();var a=this.add.tween(t).from({alpha:.1},200);a.start(),this.score+=100,1e3==this.score&&(this.add.tween(t).to({alpha:0},4e3).start(),this.add.tween(t.scale).to({x:100,y:100},2e3).start(),this.minigun.anchor.set(.5),this.add.tween(this.minigun).to({x:this.world.centerX,y:this.world.centerY},3e3).start(),this.add.tween(this.minigun.scale).to({x:5,y:5},3e3).start()),this.audioExplosion.play(),this.scoreText.text="Score: "+this.score},null,this),t=this.input.position.x,i=this.input.position.y,e=this.world.centerX,s=this.world.centerY,n=Math.atan2(i-s,t-e)*(180/Math.PI),this.player.angle=n,a=t-e,h=i-s,o=Math.sqrt(a*a+h*h)/100,this.player.scale.x=.6*o,this.player.scale.y=.6*o},toggleFullscreen:function(){this.scale.startFullScreen()},onInputDown:function(){this.game.state.start("menu")},addScore:function(){this.scoreText=this.add.bitmapText(0,0,"minecraftia","Score: "+this.score,16),this.scoreText.anchor.setTo(0,0)}},window["phaser-test2"]=window["phaser-test2"]||{},window["phaser-test2"].Game=t}(),window.onload=function(){"use strict";var t,i=window["phaser-test2"];t=new Phaser.Game(640,480,Phaser.AUTO,"phaser-test2-game"),t.state.add("boot",i.Boot),t.state.add("preloader",i.Preloader),t.state.add("menu",i.Menu),t.state.add("game",i.Game),t.state.start("boot")},function(){"use strict";function t(){this.titleTxt=null,this.startTxt=null,this.bgSprite=null,this.menuMusic=null,this.tunnelFilter=null}t.prototype={create:function(){var t=this.game.width/2,i=this.game.height/2;this.bgSprite=this.add.sprite(0,0,"cobbletexture"),this.bgSprite.width=this.game.width,this.bgSprite.height=this.game.height,this.tunnelFilter=this.add.filter("Tunnel",this.game.width,this.game.height,this.bgSprite.texture),this.tunnelFilter.origin=1,this.bgSprite.filters=[this.tunnelFilter],this.titleTxt=this.add.bitmapText(t,i,"minecraftia","Jueguito de mierda de victor"),this.titleTxt.align="center",this.titleTxt.x=this.game.width/2,this.titleTxt.anchor.setTo(.5,.5),this.rotation=.05,i=i+this.titleTxt.height+5,this.startTxt=this.add.bitmapText(t,i,"minecraftia","START"),this.startTxt.align="center",this.startTxt.anchor.set(.5),this.startTxt.x=this.game.width/2,this.startTxt.tint=1433855;var e=this.add.tween(this.titleTxt).from({rotation:-.1},500,void 0,!1,0,!1,!0),s=this.add.tween(this.startTxt.scale).from({x:3},1500,"Elastic",!1,0,!1,!0),a=this.add.tween(this.titleTxt).from({y:300},1e3,"Elastic",!1,0,!1,!0);e.start(),s.start(),a.start(),this.input.onDown.add(this.onDown,this),this.menuMusic=this.add.audio("kiss"),this.menuMusic.play()},update:function(){this.tunnelFilter.update(),this.tunnelFilter.origin+=.001},onDown:function(){this.menuMusic.stop(),this.game.state.start("game")}},window["phaser-test2"]=window["phaser-test2"]||{},window["phaser-test2"].Menu=t}(),function(){"use strict";function t(){this.asset=null,this.ready=!1}t.prototype={preload:function(){this.asset=this.add.sprite(.5*this.game.width-110,.5*this.game.height-10,"preloader"),this.load.onLoadComplete.addOnce(this.onLoadComplete,this),this.load.setPreloadSprite(this.asset),this.loadResources()},loadResources:function(){this.load.image("player","assets/player.png"),this.load.image("cobbletexture","assets/cobbletexture.png"),this.load.image("minigun","assets/minigun.png"),this.load.image("bullet","assets/bullet.png"),this.load.bitmapFont("minecraftia","assets/minecraftia.png","assets/minecraftia.xml"),this.load.spritesheet("explosion","assets/explosion.png",128,128,49),this.load.script("marble","assets/filters/Tunnel.js"),this.load.script("lightbeam","assets/filters/LightBeam.js"),this.load.script("lazerbeam","assets/filters/LazerBeam.js"),this.load.script("colorbars","assets/filters/ColorBars.js"),this.load.audio("kiss","assets/kiss.mp3",!0),this.load.audio("audio-explosion","assets/explosion.wav",!0),this.load.audio("audio-laser","assets/laser.mp3",!0)},create:function(){this.asset.cropEnabled=!1},update:function(){this.ready&&this.game.state.start("menu")},onLoadComplete:function(){this.ready=!0}},window["phaser-test2"]=window["phaser-test2"]||{},window["phaser-test2"].Preloader=t}();